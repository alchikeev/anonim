from django.core.management.base import BaseCommand
from core.models import EditablePage


class Command(BaseCommand):
    help = 'Инициализирует шаблонный контент для всех страниц на русском и кыргызском языках'

    def handle(self, *args, **options):
        # Шаблонный контент на русском языке
        ru_content = {
            'about': {
                'title': 'О проекте',
                'content': '''
                <h3>Аноним Мектеп</h3>
                <p>Аноним Мектеп — это платформа, созданная для поддержки школьников, учителей и родителей. Здесь вы можете получить консультацию, поделиться проблемой или узнать полезную информацию, сохраняя анонимность.</p>
                
                <h4>Наши цели:</h4>
                <ul>
                    <li>Создать безопасное пространство для обсуждения проблем в школах</li>
                    <li>Обеспечить анонимность и конфиденциальность</li>
                    <li>Предоставить доступ к полезной информации и ресурсам</li>
                    <li>Поддержать школьное сообщество</li>
                </ul>
                
                <h4>Как это работает:</h4>
                <p>Вы можете отправить анонимное сообщение, выбрав школу и тип проблемы. Ваше сообщение будет передано соответствующим специалистам для рассмотрения и ответа.</p>
                '''
            },
            'faq': {
                'title': 'Вопросы-ответы',
                'content': '''
                <h3>Вопросы-ответы</h3>
                
                <div class="faq-item">
                    <h4>Как работает анонимность?</h4>
                    <p>Ваши сообщения не содержат личных данных и не отслеживаются. Мы не собираем информацию, которая может идентифицировать вас.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Кто может воспользоваться сервисом?</h4>
                    <p>Любой школьник, учитель или родитель может отправить анонимное сообщение через нашу платформу.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Как получить ответ?</h4>
                    <p>Ответ поступит на указанный вами способ связи или будет опубликован на сайте в разделе "База знаний".</p>
                </div>
                
                <div class="faq-item">
                    <h4>Безопасно ли это?</h4>
                    <p>Да, мы используем современные технологии шифрования и не храним личные данные пользователей.</p>
                </div>
                '''
            },
            'service_contacts': {
                'title': 'Контакты служб',
                'content': '''
                <h3>Контакты служб</h3>
                
                <div class="contact-item">
                    <h4>Экстренные службы</h4>
                    <ul>
                        <li>Полиция: <a href="tel:102">102</a></li>
                        <li>Скорая помощь: <a href="tel:103">103</a></li>
                        <li>Пожарная служба: <a href="tel:101">101</a></li>
                        <li>Единый номер экстренных служб: <a href="tel:112">112</a></li>
                    </ul>
                </div>
                
                <div class="contact-item">
                    <h4>Образование и поддержка</h4>
                    <ul>
                        <li>Министерство образования: <a href="https://edu.gov.kg/">edu.gov.kg</a></li>
                        <li>Телефон доверия: <a href="tel:150">150</a></li>
                        <li>Психологическая помощь: <a href="tel:142">142</a></li>
                    </ul>
                </div>
                
                <div class="contact-item">
                    <h4>Детские службы</h4>
                    <ul>
                        <li>Детский телефон доверия: <a href="tel:150">150</a></li>
                        <li>Центр помощи детям: <a href="tel:+996312123456">+996 312 123 456</a></li>
                    </ul>
                </div>
                '''
            },
            'instructions': {
                'title': 'Инструкции',
                'content': '''
                <h3>Инструкции по использованию платформы</h3>
                
                <div class="instruction-step">
                    <h4>Шаг 1: Выберите школу</h4>
                    <p>На главной странице найдите вашу школу в списке или воспользуйтесь поиском.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Шаг 2: Выберите тип проблемы</h4>
                    <p>Укажите категорию вашей проблемы: буллинг, вымогательство, домогательства или другое.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Шаг 3: Опишите ситуацию</h4>
                    <p>Подробно опишите вашу проблему. Чем больше деталей, тем лучше мы сможем помочь.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Шаг 4: Укажите способ связи</h4>
                    <p>Выберите, как с вами связаться для ответа: через Telegram, email или телефон.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Шаг 5: Отправьте сообщение</h4>
                    <p>Проверьте все данные и отправьте сообщение. Оно будет передано соответствующим специалистам.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Получение ответа</h4>
                    <p>Ответ поступит на указанный вами способ связи в течение 1-3 рабочих дней.</p>
                </div>
                '''
            },
            'knowledge_base': {
                'title': 'База знаний',
                'content': '''
                <h3>База знаний</h3>
                
                <div class="knowledge-section">
                    <h4>Безопасность в школе</h4>
                    <ul>
                        <li>Правила поведения в школе</li>
                        <li>Как защитить себя от буллинга</li>
                        <li>Что делать в случае конфликтов</li>
                        <li>Права и обязанности учеников</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Психологическая поддержка</h4>
                    <ul>
                        <li>Как справиться со стрессом</li>
                        <li>Техники релаксации</li>
                        <li>Как развить уверенность в себе</li>
                        <li>Работа с эмоциями</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Правовая информация</h4>
                    <ul>
                        <li>Права детей в школе</li>
                        <li>Ответственность за буллинг</li>
                        <li>Как подать жалобу</li>
                        <li>Процедуры расследования</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Ресурсы для родителей</h4>
                    <ul>
                        <li>Как поддержать ребенка</li>
                        <li>Признаки проблем в школе</li>
                        <li>Общение с учителями</li>
                        <li>Создание безопасной среды дома</li>
                    </ul>
                </div>
                '''
            }
        }

        # Шаблонный контент на кыргызском языке
        ky_content = {
            'about': {
                'title': 'Долбоор жөнүндө',
                'content': '''
                <h3>Аноним Мектеп</h3>
                <p>Аноним Мектеп - бул мектеп окуучулары, мугалимдер жана ата-энелер үчүн колдоо көрсөтүү максатында түзүлгөн платформа. Бул жерде сиз анонимдикти сактап, кеңеш ала аласыз, көйгөйүңүз менен бөлүшө аласыз же пайдалуу маалымат ала аласыз.</p>
                
                <h4>Биздин максаттар:</h4>
                <ul>
                    <li>Мектептеги көйгөйлөрдү талкуулоо үчүн коопсуз мейкиндик түзүү</li>
                    <li>Анонимдикти жана купуялыкты камсыз кылуу</li>
                    <li>Пайдалуу маалымат жана ресурстарга кирүүнү камсыз кылуу</li>
                    <li>Мектеп коомчулугун колдоо көрсөтүү</li>
                </ul>
                
                <h4>Бул кантип иштейт:</h4>
                <p>Сиз мектепти тантап, көйгөй түрүн көрсөтүп, анонимдик билдирүү жөнөтө аласыз. Сиздин билдирүүңүз тиешелүү адистерге каралуу жана жооп берүү үчүн берилет.</p>
                '''
            },
            'faq': {
                'title': 'Суроо-жооптор',
                'content': '''
                <h3>Суроо-жооптор</h3>
                
                <div class="faq-item">
                    <h4>Анонимдик кантип иштейт?</h4>
                    <p>Сиздин билдирүүлөрүңүз жеке маалыматтарды камтыбайт жана көзөмөлдөнөт. Сизди аныктай турган маалыматтарды чогултпайбыз.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Ким бул кызматты пайдалана алат?</h4>
                    <p>Кайсы болбосун мектеп окуучусу, мугалим же ата-эне биздин платформа аркылуу анонимдик билдирүү жөнөтө алат.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Жоопту кантип аласыз?</h4>
                    <p>Жооп сиз көрсөткөн байланыш каналы аркылуу келет же сайттын "Билим базасы" бөлүмүндө жарыяланат.</p>
                </div>
                
                <div class="faq-item">
                    <h4>Бул коопсузбу?</h4>
                    <p>Ооба, биз заманбап шифрлөө технологияларын колдонобуз жана колдонуучулардын жеке маалыматтарын сактабайбыз.</p>
                </div>
                '''
            },
            'service_contacts': {
                'title': 'Кызматтардын байланыштары',
                'content': '''
                <h3>Кызматтардын байланыштары</h3>
                
                <div class="contact-item">
                    <h4>Тез жардам кызматтары</h4>
                    <ul>
                        <li>Полиция: <a href="tel:102">102</a></li>
                        <li>Тез жардам: <a href="tel:103">103</a></li>
                        <li>Өрт кызматы: <a href="tel:101">101</a></li>
                        <li>Бирдиктүү тез жардам номери: <a href="tel:112">112</a></li>
                    </ul>
                </div>
                
                <div class="contact-item">
                    <h4>Билим берүү жана колдоо</h4>
                    <ul>
                        <li>Билим берүү министрлиги: <a href="https://edu.gov.kg/">edu.gov.kg</a></li>
                        <li>Ишеним телефону: <a href="tel:150">150</a></li>
                        <li>Психологиялык жардам: <a href="tel:142">142</a></li>
                    </ul>
                </div>
                
                <div class="contact-item">
                    <h4>Балдар кызматтары</h4>
                    <ul>
                        <li>Балдар ишеним телефону: <a href="tel:150">150</a></li>
                        <li>Балдарга жардам көрсөтүү борбору: <a href="tel:+996312123456">+996 312 123 456</a></li>
                    </ul>
                </div>
                '''
            },
            'instructions': {
                'title': 'Колдонуу көрсөтмөлөрү',
                'content': '''
                <h3>Платформаны колдонуу көрсөтмөлөрү</h3>
                
                <div class="instruction-step">
                    <h4>1-кадам: Мектепти тантаңыз</h4>
                    <p>Башкы бетте мектебиңизди тизмеден табыңыз же издөөнү колдонуңуз.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>2-кадам: Көйгөй түрүн тантаңыз</h4>
                    <p>Көйгөйүңүздүн категориясын көрсөтүңүз: буллинг, акча талап кылуу, зордук-зомбулук же башка.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>3-кадам: Жагдайды сүрөттөңүз</h4>
                    <p>Көйгөйүңүздү толук сүрөттөңүз. Көбүрөөк деталдар болсо, анда биз көбүрөөк жардам бере алабыз.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>4-кадам: Байланыш ыкмасын көрсөтүңүз</h4>
                    <p>Жооп берүү үчүн кантип байланышуу керектигин тантаңыз: Telegram, email же телефон аркылуу.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>5-кадам: Билдирүүнү жөнөтүңүз</h4>
                    <p>Бардык маалыматтарды текшерип, билдирүүнү жөнөтүңүз. Ал тиешелүү адистерге берилет.</p>
                </div>
                
                <div class="instruction-step">
                    <h4>Жооп алуу</h4>
                    <p>Жооп көрсөткөн байланыш каналыңызга 1-3 иш күнү ичинде келет.</p>
                </div>
                '''
            },
            'knowledge_base': {
                'title': 'Билим базасы',
                'content': '''
                <h3>Билим базасы</h3>
                
                <div class="knowledge-section">
                    <h4>Мектепте коопсуздук</h4>
                    <ul>
                        <li>Мектепте жүрүү-туруу эрежелери</li>
                        <li>Буллингден кантип коргонуу</li>
                        <li>Талаш-тартыш учурунда эмне кылуу</li>
                        <li>Окуучулардын укуктары жана милдеттери</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Психологиялык колдоо</h4>
                    <ul>
                        <li>Стресс менен кантип күрөшүү</li>
                        <li>Эс алуу техникалары</li>
                        <li>Өзүнө ишенимди кантип өстүрүү</li>
                        <li>Эмоциялар менен иштөө</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Укуктук маалымат</h4>
                    <ul>
                        <li>Мектепте балдардын укуктары</li>
                        <li>Буллинг үчүн жоопкерчилик</li>
                    </ul>
                </div>
                
                <div class="knowledge-section">
                    <h4>Ата-энелер үчүн ресурстар</h4>
                    <ul>
                        <li>Баланы кантип колдоо көрсөтүү</li>
                        <li>Мектептеги көйгөйлөрдүн белгилери</li>
                        <li>Мугалимдер менен сүйлөшүү</li>
                        <li>Үйдө коопсуз чөйрө түзүү</li>
                    </ul>
                </div>
                '''
            }
        }

        # Создаем страницы для каждого языка
        created_count = 0
        for page_key, page_choices in EditablePage.PAGE_CHOICES:
            for language, lang_name in EditablePage.LANGUAGE_CHOICES:
                # Проверяем, существует ли уже такая страница
                if not EditablePage.objects.filter(page=page_key, language=language).exists():
                    content_data = ru_content if language == 'ru' else ky_content
                    
                    if page_key in content_data:
                        EditablePage.objects.create(
                            page=page_key,
                            language=language,
                            title=content_data[page_key]['title'],
                            content=content_data[page_key]['content']
                        )
                        created_count += 1
                        self.stdout.write(
                            self.style.SUCCESS(f'✅ Создана страница: {page_choices} ({lang_name})')
                        )
                    else:
                        self.stdout.write(
                            self.style.WARNING(f'⚠️  Нет контента для: {page_choices} ({lang_name})')
                        )
                else:
                    self.stdout.write(
                        self.style.WARNING(f'⚠️  Страница уже существует: {page_choices} ({lang_name})')
                    )

        self.stdout.write(
            self.style.SUCCESS(f'\n🎉 Инициализация завершена! Создано страниц: {created_count}')
        )
